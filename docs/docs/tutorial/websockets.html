<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <title>WSP Demo</title>
        <base href="https://jerryi.github.io/tinyweb-mathematica">
        <link type="text/css" rel="stylesheet" href="https://jerryi.github.io/tinyweb-mathematica/styles.css" />
        

    </head><body class="home"><div class="navbar navbar-static-top navbar-fixed-top bs-docs-nav" id="top" role="banner">
    <div class="header-container">
        <div class="navbar-header">
            <a href="https://jerryi.github.io/tinyweb-mathematica/" class="navbar-brand">
                <div class="fire pb-3">
                    <div class="flames" id="logoFlames" style="display: block">
                       <div class="flame"></div>
                       <div class="flame"></div>
                       <div class="flame"></div>
                       <div class="flame"></div>
                    </div>
                    <img height="44" id="logoico" src="https://jerryi.github.io/tinyweb-mathematica/mathematicaIcon.svg" />
                    <div id="smoke" style="display: none">
                      <span class="s0"></span>
                      <span class="s1"></span>
                      <span class="s2"></span>
                      <span class="s3"></span>
                      <span class="s4"></span>
                      <span class="s5"></span>
                      <span class="s6"></span>
                      <span class="s7"></span>
                      <span class="s8"></span>
                      <span class="s9"></span>
                    </div>
                 </div>
            </a>
        </div>
        <nav class="collapse navbar-collapse bs-navbar-collapse" role="navigation">
            <ul class="nav navbar-nav">
                <li class=""><a href="https://jerryi.github.io/tinyweb-mathematica/">Overview</a></li>
                <li class=""><a href="https://jerryi.github.io/tinyweb-mathematica/docs/index.html">Docs</a></li>
            </ul>
        </nav>
    </div>
</div>

<script>
    var rotationdegrees = 0;

    core.Pong = function(args, env) {
      console.log("[p]");
      rotationdegrees = rotationdegrees + 90;
      document.getElementById("logoico").style= "transform: rotate("+rotationdegrees+"deg);";
    };
</script><div class="bs-docs-home" id="content" role="main">
            <div class="container"><div class="col-md-3 sidebar">
    <ul class="list-group">
        <li class="list-group-item level-0 active"><a>TinyWEB</a></li>
        <li class="list-group-item level-2"><a href="https://jerryi.github.io/tinyweb-mathematica/docs/index.html">Get started</a></li>
        <li class="list-group-item level-2"><a href="https://jerryi.github.io/tinyweb-mathematica/docs/tutorial/forms.html">Forms</a></li>
        <li class="list-group-item level-2"><a href="https://jerryi.github.io/tinyweb-mathematica/docs/tutorial/websockets.html">Websockets</a></li>        

        <li class="list-group-item level-0 active"><a>WSP</a></li>
        <li class="list-group-item level-2"><a href="https://jerryi.github.io/tinyweb-mathematica/docs/tutorial/wspoverview.html">Overview</a></li>
        <li class="list-group-item level-2"><a href="https://jerryi.github.io/tinyweb-mathematica/docs/tutorial/components.html">Components</a></li>
        <li class="list-group-item level-2"><a href="https://jerryi.github.io/tinyweb-mathematica/docs/tutorial/session.html">Session</a></li>
    </ul>
</div>

                <div class="col-md-9 main"><h1 class="heading">
    Websockets
</h1>
<p>Built on-top of the HTTP protocol as its upgrade feature. Keeps the connection alive until user closes the tab. Allows to have a full duplex channel between server an unlimited number of clients.</p>
<h2 class="heading">Setting up the connection</h2>
<p>For the simplicity there is a special JS script (or let's say a tiny framework) <span class="cm-tag">framework.js</span>, which contais all necessary functions. Just put the following lines somewhere in your header file</p>

<div class="example">
    <code class="language-mathematica" style="margin-left: 0;">
        <span class="cm-tag">
            &lt;script type=&quot;text/javascript&quot; src=&quot;websockets.js&quot;&gt;&lt;/script&gt;<br />
            &lt;script&gt;<br />
            &nbsp;&nbsp;&nbsp;&nbsp;    WSPSetHost(&quot;&lt;?wsphost?&gt;&quot;);<br />
            &lt;/script&gt; 
        </span> 
    </code>
</div>
<p class="example-caption">It will define the default url to the address of your webserver<b>a^\[Currency]\264</b></p>

<p>In the Wolfram's console the message "websocket handshake" should pop up, when you open the webpage.</p>

<h2 class="heading">Send the data to client</h2>
<p>There are a few ways, how to do it.</p>
<h3 class="heading">Broadcast to all clients</h2>
<div class="example">
    <code class="language-mathematica" style="margin-left: 0;">
     
            WebSocketBroadcast[server, expression]
  
    </code>
</div>
<p>Where the expression field should be WL symbol like</p>
<div class="example">
    <code class="language-mathematica" style="margin-left: 0;">
    
            WebSocketBroadcast[server, CustomFunction[Table[i, {i,1,10}], "Hello!"]]
     
    </code>
</div>
<p>This function will be converted to JSON array including all arguments. On the client's side the corresponding function must be</p>
<div class="example">
    <code class="language-mathematica" style="margin-left: 0;">
        <span class="cm-tag">
            core.CustomFunction = function(args, env) {<br>
                &nbsp;&nbsp;&nbsp;&nbsp;console.log(interpretate(args[0]));<br>
                &nbsp;&nbsp;&nbsp;&nbsp;console.log(args[1]);<br>
            };
        </span> 
    </code>
</div>
<p class="example-caption">Place it somewhere in the footer. It will print all two arguments you sent<b>a^\[Currency]\264</b></p>
<p>If you are sure that the argument will be a string, you can ommit interpretate function, which decodes Mathematica's expressions.</p>

<h3 class="heading">Broadcast to the channel</h2>
    <p>this section is in the development</p> 

<h3 class="heading">Subscribe to the channel</h2>
    <p>this section is in the development</p>  

<h2 class="heading">Send the data to the server</h2>
<p>this section is in the development</p> 
<!--<h2 class="heading">
    Related documentation
</h2>
<ul>
    <li><a href="https://github.com/share/sharedb">ShareDB</a></li>
</ul>--><div class="bs-docs-footer footer" role="contentinfo">
    <div class="container">
        <ul class="bs-docs-footer-links muted">
            <li><a href="https://github.com/JerryI/tinyweb-mathematica" target="_blank">GitHub</a></li>
            <li>A^\[CenterDot]</li>
            <li><a href="https://github.com/JerryI/tinyweb-mathematica/issues?state=open" target="_blank">Issues</a></li>
        </ul>
        <p class="attribution">Code licensed under <a href="https://opensource.org/licenses/MIT" target="_blank">MIT</a>, documentation under <a href="https://creativecommons.org/licenses/by/3.0/" target="_blank">CC BY 3.0</a>.</p>
    </div>
</div>
</div>
</div>
    

</div>
<table cellspacing="0" cellpadding="0" class="gstl_50 gssb_c" style="width: 250px; display: none; top: 46px; left: 904px; position: absolute;">
<tbody>
<tr>
<td class="gssb_f"></td>
<td class="gssb_e" style="width: 100%;"></td>
</tr>
</tbody>
</table>
</body>
</html>CharacterEncoding -> UTF8